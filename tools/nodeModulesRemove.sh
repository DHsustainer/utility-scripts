#!/bin/bash

echo "============================================================"
echo "                                                            "
echo "                                                            "
echo "  |  _ \| | | / ___| _   _ ___| |_ __ _(_)_ __   ___ _ __   "
echo "  | | | | |_| \___ \| | | / __| __/ _` | | '_ \ / _ \ '__|  "
echo "  | |_| |  _  |___) | |_| \__ \ || (_| | | | | |  __/ |     " 
echo "  |____/|_| |_|____/ \__,_|___/\__\__,_|_|_| |_|\___|_|     "
echo "                                                            "
echo "                                                            "
echo "                      Node modules remove                   "
echo "                                                            "
echo "============================================================" 

function show_help {
    echo -e "\033[1;33m=================================================\033[0m"
    echo -e "\033[1;32m Usage: $0 DIRECTORY_PATH"
    echo -e "\033[1;33m=================================================\033[0m"
}

if [ "$1" == "-h" ]; then
    show_help
    exit 0
fi

if [ -z "$1" ]; then
    echo -e "\033[1;33m=================================================\033[0m"
    echo -e "\033[1;32m Remember Usage: $0 DIRECTORY_PATH \033[0m "
    echo -e "\033[1;33m=================================================\033[0m"
    exit 1
fi

DIR_PATH=$1

if [ ! -d "$DIR_PATH" ]; then
    echo -e "\033[1;33m=================================================\033[0m"
    echo -e "\033[1;32m The specified path is not a directory: $DIR_PATH \033[0m "
    echo -e "\033[1;33m=================================================\033[0m"
    exit 1
fi

echo -e "\033[1;33m=================================================\033[0m"
echo -e "\033[1;32m Entering directory $DIR_PATH \033[0m"
echo -e "\033[1;33m=================================================\033[0m"

cd "$DIR_PATH"

echo -e "\033[1;33m=================================================\033[0m"
echo -e "\033[1;32m Removing all node_modules directories...\033[0m üê≥"
echo -e "\033[1;33m=================================================\033[0m"

find . -name "node_modules" -type d -prune -exec rm -rf '{}' +

echo -e "\033[1;33m=================================================\033[0m"
echo -e "\033[1;32m Node Modules successfully removed\033[0m üöÄ"
echo -e "\033[1;33m=================================================\033[0m"
